# Contribuci√≥n a RogueBot

Gracias por contribuir a RogueBot. Esta gu√≠a resume el flujo de trabajo del repositorio y c√≥mo a√±adir tests sin romper el CI.

---

## üß© Flujo de trabajo (resumen)

1. Crear rama desde `develop`:

```bash
git checkout develop
git pull
git checkout -b <tipo>/<nombre-corto>
```

2. Commits peque√±os y descriptivos:

```bash
git add .
git commit -m "<tipo>: descripci√≥n breve"
```

3. Push y Pull Request a `develop`:

```bash
git push -u origin <tipo>/<nombre-corto>
```

> Recomendaci√≥n: usar prefijos como `feature/`, `fix/`, `chore/`, `docs/`.

---

## üß™ Tests (CTest): c√≥mo ejecutar, a√±adir y etiquetar

Los tests se compilan con CMake y se registran en CTest desde `tests/CMakeLists.txt`.

### Ejecutar tests (reproducir CI)

```bash
cmake -S . -B build-tests -DBUILD_TESTING=ON
cmake --build build-tests -j
ctest --test-dir build-tests -L unit --output-on-failure
ctest --test-dir build-tests -L integration --output-on-failure
```

**Criterio de clasificaci√≥n:**
- `unit`: tests de l√≥gica pura (sin assets, filesystem, locales, gettext ni raylib).
- `integration`: tests que dependen de assets, filesystem, locales, gettext o raylib.

---

## ‚ûï A√±adir un test nuevo

1. Crear el fichero del test en `tests/` usando Boost.Test.
2. En `tests/CMakeLists.txt`, a√±adir:
   - `add_executable(...)`
   - `rb_link_boost_test(...)`
   - `add_test(NAME ... COMMAND ...)`
3. Asignar `WORKING_DIRECTORY` si aplica y etiquetar el test.

---

## üè∑Ô∏è Etiquetado con `rb_label_test`

Todos los tests deben etiquetarse usando el helper `rb_label_test`.

Se usan **dos labels**:
- **scope**: `unit` o `integration`
- **category**: `utils`, `map`, `assets`, `i18n`

### Ejemplo (test unitario de utils)

```cmake
add_test(NAME mi_test COMMAND rb_test_mi_test)

set_tests_properties(mi_test PROPERTIES
  WORKING_DIRECTORY ${PROJECT_SOURCE_DIR}
)

rb_label_test(mi_test unit utils)
```

### Ejemplo (test de integraci√≥n con assets)

```cmake
add_test(NAME mi_test_assets COMMAND rb_test_mi_test_assets)

set_tests_properties(mi_test_assets PROPERTIES
  WORKING_DIRECTORY ${PROJECT_SOURCE_DIR}
)

rb_label_test(mi_test_assets integration assets)
```

---

## Nota sobre tests de i18n

Algunos tests de `i18n` requieren locales y gettext.  
Si alg√∫n test falla por configuraci√≥n regional, prueba:

```bash
export LANG=es_ES.UTF-8
export LC_ALL=es_ES.UTF-8
export LANGUAGE=es
```

En Linux, aseg√∫rate de tener los locales instalados:

```bash
sudo apt-get update
sudo apt-get install -y locales gettext
sudo locale-gen es_ES.UTF-8
sudo locale-gen en_GB.UTF-8
```
